<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ROOMI — Sell / Rent</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header class="app-header">
    <div class="header-inner">
      <a href="index.html" class="logo-link">
        <img src="images/logo.png" alt="ROOMI" class="logo-img">
        <span class="logo-text">ROOMI</span>
      </a>
      <div class="header-right">
        <button type="button" class="nav-toggle" aria-label="Menu" aria-expanded="false"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="4" y1="6" x2="20" y2="6"/><line x1="4" y1="12" x2="20" y2="12"/><line x1="4" y1="18" x2="20" y2="18"/></svg></button>
        <nav class="nav-links">
          <a href="index.html" data-i18n="nav_home">Home</a>
          <a href="stock.html" data-i18n="nav_stock">Stock</a>
          <a href="items.html" data-i18n="nav_items">Items</a>
          <a href="customers.html" data-i18n="nav_customers">Customers</a>
        </nav>
        <span class="lang-switcher">
          <a href="#" class="lang-switch" data-lang="en">EN</a> <span class="lang-sep">|</span> <a href="#" class="lang-switch" data-lang="ja">日本語</a>
        </span>
      </div>
    </div>
  </header>
  <main>
    <h2 class="page-title" data-i18n="output_title">Sell / Rent</h2>
    <p class="page-intro" data-i18n="output_intro">Pick from inventory (in stock, listed, or reserved) to sell or rent.</p>
    <div id="alert" class="alert hidden"></div>

    <div class="tabs">
      <button type="button" class="tab-btn active" data-tab="sell" data-i18n="tab_sell">Sell</button>
      <button type="button" class="tab-btn" data-tab="rent" data-i18n="tab_rent">Rent</button>
    </div>

    <div id="pane-sell" class="tab-pane active">
      <div class="card">
        <h3 data-i18n="create_sale">Create sale</h3>
        <form id="sell-form">
          <div class="form-group">
            <label data-i18n="search_pick_item">Search & pick item *</label>
            <input type="text" id="sell-search" data-i18n-placeholder="search_by_title" placeholder="Search by title…">
            <select id="sell-item_id" required style="margin-top:0.35rem;">
              <option value="" data-i18n="select_item_placeholder">— Select item —</option>
            </select>
          </div>
          <div class="form-group">
            <label data-i18n="customer_required">Customer *</label>
            <select id="sell-customer_id">
              <option value="" data-i18n="select_customer_placeholder">— Select existing or add new below —</option>
            </select>
          </div>
          <div class="form-group" id="sell-quick-customer" style="display:none;">
            <label data-i18n="quick_add_customer">Quick add customer</label>
            <select id="sell-new-platform" style="margin-bottom:0.35rem;">
              <option value="" data-i18n="platform_dropdown">— Platform —</option>
              <option value="line">Line</option>
              <option value="facebook" data-i18n="platform_facebook">Facebook</option>
              <option value="rednote" data-i18n="platform_rednote">Rednote</option>
              <option value="mercari" data-i18n="platform_mercari">Mercari</option>
              <option value="jimoty" data-i18n="platform_jimoty">Jimoty</option>
              <option value="yahoo_auctions" data-i18n="platform_yahoo_auctions">Yahoo Auctions</option>
              <option value="other" data-i18n="platform_other">Other</option>
            </select>
            <input type="text" id="sell-new-platform-other" class="hidden" data-i18n-placeholder="platform_name_placeholder" placeholder="Platform name…" style="margin-bottom:0.35rem;">
            <input type="text" id="sell-new-name" data-i18n-placeholder="name_required" placeholder="Name *" style="margin-bottom:0.35rem;">
            <input type="text" id="sell-new-app_id" data-i18n-placeholder="app_id_placeholder" placeholder="ID on platform (app ID)">
          </div>
          <div class="form-group">
            <label><input type="checkbox" id="sell-use-new-customer"> <span data-i18n="use_new_customer">Use new customer (above)</span></label>
          </div>
          <div class="form-row form-row-2">
            <div class="form-group">
              <label data-i18n="sale_price_required">Sale price (¥) *</label>
              <input type="number" id="sell-sale_price" min="0" step="0.01" required>
            </div>
            <div class="form-group">
              <label data-i18n="sale_date_required">Sale date *</label>
              <input type="date" id="sell-sale_date" required>
            </div>
          </div>
          <div class="form-group">
            <a href="#" id="sell-toggle-exact-location" class="link-secondary" data-i18n="add_exact_location_where">+ Add exact location — where item will go (optional)</a>
            <div id="sell-exact-location-wrap" class="hidden" style="margin-top:0.35rem;">
              <label data-i18n="exact_location">Exact location</label>
              <input type="text" id="sell-exact_location" data-i18n-placeholder="placeholder_delivery" placeholder="e.g. address or delivery spot">
            </div>
          </div>
          <div class="form-group">
            <label data-i18n="notes">Notes</label>
            <textarea id="sell-notes" rows="2"></textarea>
          </div>
          <button type="submit" class="btn btn-primary" data-i18n="confirm_sell_btn">Confirm & sell</button>
        </form>
      </div>
    </div>

    <div id="pane-rent" class="tab-pane">
      <div class="card">
        <h3 data-i18n="create_rental">Create rental</h3>
        <form id="rent-form">
          <div class="form-group">
            <label data-i18n="search_pick_item">Search & pick item *</label>
            <input type="text" id="rent-search" data-i18n-placeholder="search_by_title" placeholder="Search by title…">
            <select id="rent-item_id" required style="margin-top:0.35rem;">
              <option value="" data-i18n="select_item_placeholder">— Select item —</option>
            </select>
          </div>
          <div class="form-group">
            <label data-i18n="customer_required">Customer *</label>
            <select id="rent-customer_id">
              <option value="" data-i18n="select_customer_placeholder">— Select existing or add new below —</option>
            </select>
          </div>
          <div class="form-group" id="rent-quick-customer" style="display:none;">
            <label data-i18n="quick_add_customer">Quick add customer</label>
            <select id="rent-new-platform" style="margin-bottom:0.35rem;">
              <option value="" data-i18n="platform_dropdown">— Platform —</option>
              <option value="line">Line</option>
              <option value="facebook" data-i18n="platform_facebook">Facebook</option>
              <option value="rednote" data-i18n="platform_rednote">Rednote</option>
              <option value="mercari" data-i18n="platform_mercari">Mercari</option>
              <option value="jimoty" data-i18n="platform_jimoty">Jimoty</option>
              <option value="yahoo_auctions" data-i18n="platform_yahoo_auctions">Yahoo Auctions</option>
              <option value="other" data-i18n="platform_other">Other</option>
            </select>
            <input type="text" id="rent-new-platform-other" class="hidden" data-i18n-placeholder="platform_name_placeholder" placeholder="Platform name…" style="margin-bottom:0.35rem;">
            <input type="text" id="rent-new-name" data-i18n-placeholder="name_required" placeholder="Name *" style="margin-bottom:0.35rem;">
            <input type="text" id="rent-new-app_id" data-i18n-placeholder="app_id_placeholder" placeholder="ID on platform (app ID)">
          </div>
          <div class="form-group">
            <label><input type="checkbox" id="rent-use-new-customer"> <span data-i18n="use_new_customer">Use new customer (above)</span></label>
          </div>
          <div class="form-row form-row-2">
            <div class="form-group">
              <label data-i18n="rent_monthly_required">Rent monthly (¥) *</label>
              <input type="number" id="rent-rent_price_monthly" min="0" step="0.01" required>
            </div>
            <div class="form-group">
              <label data-i18n="deposit">Deposit (¥)</label>
              <input type="number" id="rent-deposit" min="0" step="0.01" data-i18n-placeholder="placeholder_optional" placeholder="Optional">
            </div>
          </div>
          <div class="form-row form-row-2">
            <div class="form-group">
              <label data-i18n="start_date_required">Start date *</label>
              <input type="date" id="rent-start_date" required>
            </div>
            <div class="form-group">
              <label data-i18n="expected_end_date">Expected end date</label>
              <input type="date" id="rent-expected_end_date" data-i18n-placeholder="placeholder_optional" placeholder="Optional">
            </div>
          </div>
          <div class="form-group">
            <a href="#" id="rent-toggle-exact-location" class="link-secondary" data-i18n="add_exact_location_where">+ Add exact location — where item will go (optional)</a>
            <div id="rent-exact-location-wrap" class="hidden" style="margin-top:0.35rem;">
              <label data-i18n="exact_location">Exact location</label>
              <input type="text" id="rent-exact_location" data-i18n-placeholder="placeholder_delivery" placeholder="e.g. address or delivery spot">
            </div>
          </div>
          <div class="form-group">
            <label data-i18n="notes">Notes</label>
            <textarea id="rent-notes" rows="2"></textarea>
          </div>
          <button type="submit" class="btn btn-primary" data-i18n="confirm_rent_btn">Confirm & start rental</button>
        </form>
      </div>

      <div class="card mt-1">
        <h3 data-i18n="end_rental">End rental</h3>
        <div id="active-rentals" class="loading" data-i18n="loading">Loading…</div>
      </div>
    </div>
  </main>
  <div id="end-rental-modal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-header">
        <h3 data-i18n="end_rental">End rental</h3>
        <button type="button" class="modal-close" id="end-rental-close">&times;</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="end-rental-id">
        <div class="form-group">
          <label data-i18n="end_date_required">End date *</label>
          <input type="date" id="end-rental-date" required>
        </div>
        <div class="form-group">
          <label data-i18n="item_status_after">Item status after return</label>
          <select id="end-rental-item-status">
            <option value="in_stock" data-i18n="status_in_stock">in_stock</option>
            <option value="listed" data-i18n="status_listed">listed</option>
          </select>
        </div>
        <div class="form-group">
          <label data-i18n="damage_fee">Damage fee (¥)</label>
          <input type="number" id="end-rental-damage" min="0" step="0.01" data-i18n-placeholder="placeholder_optional" placeholder="Optional">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="end-rental-cancel" data-i18n="cancel">Cancel</button>
        <button type="button" class="btn btn-primary" id="end-rental-confirm" data-i18n="end_rental_confirm">End rental</button>
      </div>
    </div>
  </div>
  <div id="toast-container" class="toast-container"></div>
  <script src="js/header.js"></script>
  <script src="js/api.js"></script>
  <script src="js/i18n.js"></script>
  <script>document.querySelectorAll('.lang-switch').forEach(function(a){ a.addEventListener('click', function(e){ e.preventDefault(); setRoomiLang(this.dataset.lang); }); }); applyI18n();</script>
  <script src="js/output.js"></script>
</body>
</html>
