// File: frontend/js/i18n.js
// English / 日本語 for ROOMI

var ROOMI_I18N = {
  en: {
    nav_home: 'Home',
    nav_input: 'Input (Buy)',
    nav_output: 'Output (Sell/Rent)',
    nav_stock: 'Stock',
    nav_items: 'Items',
    nav_customers: 'Customers',
    nav_rentals: 'Rentals',
    nav_sales: 'Sales',
    lang_en: 'EN',
    lang_ja: '日本語',
    dashboard: 'Dashboard',
    workflow: 'Workflow',
    flow_input: 'Input (Buy / Acquire Stock)',
    flow_inventory: 'Inventory',
    flow_output: 'Output (Sell / Rent)',
    in_stock: 'In Stock',
    listed: 'Listed',
    rented: 'Rented',
    sold: 'Sold',
    recently_added: 'Recently added items',
    no_items_yet: 'No items yet.',
    acquire_first: 'Acquire your first item',
    buy_title: 'Buy / Acquire Stock',
    buy_intro: 'Record items you obtain from Rednote, Facebook, friends, etc. New items are set to in_stock.',
    new_acquisition: 'New acquisition',
    title: 'Title',
    category: 'Category',
    main_category: 'Main Category',
    sub_category: 'Sub Category',
    select_sub_first: '— Select main first —',
    sub_category_required: 'Please select a sub category.',
    acquisition_date: 'Acquisition date',
    source_platform: 'Source platform',
    acquisition_type: 'Acquisition type',
    acquisition_cost: 'Acquisition cost (¥)',
    original_price: 'Original price (¥) — for damage',
    condition: 'Condition',
    location_area: 'Location area',
    notes: 'Notes',
    save_acquisition: 'Save acquisition',
    recently_acquired: 'Recently acquired (last 10)',
    no_acquisitions: 'No acquisitions yet. Add one above.',
    filters: 'Filters',
    status: 'Status',
    location: 'Location',
    search_title: 'Search title',
    all: 'All',
    apply: 'Apply',
    clear_filters: 'Clear filters',
    all_items: 'All items',
    add_item: 'Add item',
    no_items_match: 'No items match the filters.',
    edit: 'Edit',
    delete: 'Delete',
    loading: 'Loading…',
    save: 'Save',
    cancel: 'Cancel',
    actions: 'Actions',
    id: 'ID',
    actions_label: 'Actions',
    new_good: 'good',
    new_fair: 'fair',
    new_poor: 'poor',
    free: 'free',
    cheap: 'cheap',
    bought: 'bought',
    output_title: 'Sell / Rent',
    output_intro: 'Pick from inventory (in stock, listed, or reserved) to sell or rent.',
    tab_sell: 'Sell',
    tab_rent: 'Rent',
    create_sale: 'Create sale',
    create_rental: 'Create rental',
    search_pick_item: 'Search & pick item',
    customer: 'Customer',
    sale_price: 'Sale price (¥)',
    sale_date: 'Sale date',
    platform_sold: 'Platform sold',
    confirm_sell: 'Confirm & sell',
    rent_monthly: 'Rent monthly (¥)',
    deposit: 'Deposit (¥)',
    start_date: 'Start date',
    expected_end_date: 'Expected end date',
    confirm_rent: 'Confirm & start rental',
    end_rental: 'End rental',
    active_rentals: 'Active rentals',
    no_active_rentals: 'No active rentals.',
    end_rental_btn: 'End rental',
    end_date: 'End date',
    item_status_after: 'Item status after return',
    damage_fee: 'Damage fee (¥)',
    end_rental_confirm: 'End rental',
    select_item: 'Select item',
    select_customer: 'Select existing or add new below',
    use_new_customer: 'Use new customer (above)',
    quick_add_customer: 'Quick add customer',
    customers_title: 'Customers',
    all_customers: 'All customers',
    add_customer: 'Add customer',
    no_customers: 'No customers yet. Add one to get started.',
    rentals_title: 'Rentals',
    sales_title: 'Sales',
    new_sale: 'New sale',
    new_rental: 'New rental',
    item_acquired: 'Item acquired and added to inventory.',
    sale_recorded: 'Sale recorded. Item marked as sold.',
    rental_started: 'Rental started. Item marked as rented.',
    rental_ended: 'Rental ended.',
    failed_load: 'Failed to load.',
    buy_intro_html: 'Record items you obtain from Rednote, Facebook, friends, etc. New items are set to <strong>in_stock</strong>.',
    select_placeholder: '— Select —',
    cat_fridge: 'fridge',
    cat_washing_machine: 'washing machine',
    cat_bed: 'bed',
    cat_desk: 'desk',
    cat_sofa: 'sofa',
    cat_table: 'table',
    cat_chair: 'chair',
    cat_other: 'other',
    cond_new: 'new',
    platform_rednote: 'Rednote',
    platform_facebook: 'Facebook',
    platform_friends: 'Friends',
    platform_mercari: 'Mercari',
    platform_jimoty: 'Jimoty',
    platform_yahoo_auctions: 'Yahoo Auctions',
    platform_other: 'Other',
    placeholder_title: 'e.g. Small fridge',
    placeholder_optional: 'Optional',
    placeholder_location: 'e.g. Shinjuku, Ikebukuro',
    placeholder_exact_location: 'e.g. address or precise spot',
    placeholder_platform_other: 'Type platform name…',
    add_exact_location: '+ Add exact location (optional)',
    hide_exact_location: '− Hide exact location',
    exact_location: 'Exact location',
    status_in_stock: 'in_stock',
    status_listed: 'listed',
    status_rented: 'rented',
    status_sold: 'sold',
    status_reserved: 'reserved',
    status_disposed: 'disposed',
    edit_rent_sale_note: 'To record a rental or sale (so it appears on Rentals/Sales pages), use the rented or sold buttons in the table — they open the Output page to record the transaction.',
    select_item_placeholder: '— Select item —',
    select_customer_placeholder: '— Select existing or add new below —',
    platform_dropdown: '— Platform —',
    name_required: 'Name *',
    app_id_placeholder: 'ID on platform (app ID)',
    platform_name_placeholder: 'Platform name…',
    add_exact_location_where: '+ Add exact location — where item will go (optional)',
    placeholder_delivery: 'e.g. address or delivery spot',
    confirm_sell_btn: 'Confirm & sell',
    confirm_rent_btn: 'Confirm & start rental',
    search_by_title: 'Search by title…',
    customer_required: 'Customer *',
    sale_price_required: 'Sale price (¥) *',
    sale_date_required: 'Sale date *',
    rent_monthly_required: 'Rent monthly (¥) *',
    start_date_required: 'Start date *',
    end_date_required: 'End date *',
    item_available_sell: 'Item (available to sell) *',
    item_available_rent: 'Item (available) *',
    rent_price_monthly_label: 'Rent price monthly (¥) *',
    all_sales: 'All sales',
    no_sales_yet: 'No sales yet.',
    no_sales_hint: 'Sale records appear here when you use Output (Sell/Rent) → Sell tab, or the New sale button above. Changing an item\'s status to "sold" in Items → Edit does not create a sale record.',
    no_rentals_match: 'No rentals match.',
    no_rentals_hint: 'Rental records appear here when you use Output (Sell/Rent) → Rent tab, or the New rental button above. Changing an item\'s status to "rented" in Items → Edit does not create a rental record.',
    modal_add_customer: 'Add customer',
    modal_new_sale: 'New sale',
    modal_new_rental: 'New rental',
    modal_edit_customer: 'Edit customer',
    modal_reserve_item: 'Reserve item',
    name_label: 'Name *',
    phone_label: 'Phone',
    email_label: 'Email',
    preferred_language_label: 'Preferred language',
    customer_type_label: 'Customer type',
    lang_japanese: 'Japanese',
    lang_english: 'English',
    lang_chinese: 'Chinese',
    type_buyer: 'buyer',
    type_renter: 'renter',
    type_both: 'both',
    sale_created: 'Sale created. Item status set to sold.',
    rental_created: 'Rental created. Item set to rented.',
    rental_ended_msg: 'Rental ended. Item set back to in_stock.',
    damage_fee_set: 'Damage fee set.',
    item_updated: 'Item updated.',
    item_added: 'Item added.',
    item_deleted: 'Item deleted (disposed).',
    status_updated: 'Status updated to',
    please_select_customer: 'Please select a customer.',
    item_reserved: 'Item marked as reserved.',
    failed_load_dashboard: 'Could not load dashboard:',
    failed_load_backend: 'Failed to load. Is the backend running?',
    select_customer_short: '— Select customer —',
    when_ending_rental: 'When ending rental',
    all_rentals: 'All rentals',
    status_active: 'Active',
    status_ended: 'Ended',
    status_overdue: 'Overdue',
    mark_damaged: 'Mark damaged',
    damage_fee_default_label: 'Damage fee (¥) — default: item original price',
    set_damage_fee: 'Set damage fee',
    customer_updated: 'Customer updated.',
    customer_added: 'Customer added.',
    item: 'Item',
    monthly: 'Monthly (¥)',
    start: 'Start',
    end: 'End',
    add_item: 'Add item',
    edit_item: 'Edit item',
    name: 'Name',
    language: 'Language',
    type: 'Type',
    error_prefix: 'Error: ',
    error_unexpected: 'Error: unexpected response.',
    reserve_btn: 'Mark reserved',
    undecided_yet: 'Undecided yet',
    stock_title: 'Stock',
    section_input: 'Input (Buy)',
    section_output: 'Output (Sell/Rent)',
    card_buy: 'Buy',
    card_rent_sell: 'Rent / Sell',
  },
  ja: {
    nav_home: 'ホーム',
    nav_input: '入力（仕入）',
    nav_output: '出力（販売・レンタル）',
    nav_stock: '在庫入出',
    nav_items: '商品一覧',
    nav_customers: '顧客',
    nav_rentals: 'レンタル',
    nav_sales: '販売',
    lang_en: 'EN',
    lang_ja: '日本語',
    dashboard: 'ダッシュボード',
    workflow: 'ワークフロー',
    flow_input: '入力（仕入・在庫確保）',
    flow_inventory: '在庫',
    flow_output: '出力（販売・レンタル）',
    in_stock: '在庫',
    listed: '掲載中',
    rented: 'レンタル中',
    sold: '売却済',
    recently_added: '最近追加した商品',
    no_items_yet: 'まだ商品がありません。',
    acquire_first: '最初の商品を仕入れる',
    buy_title: '仕入・在庫確保',
    buy_intro: 'Rednote、Facebook、知人などで入手した商品を記録します。新規は「在庫」になります。',
    new_acquisition: '新規仕入',
    title: 'タイトル',
    category: 'カテゴリ',
    main_category: '大カテゴリ',
    sub_category: 'サブカテゴリ',
    select_sub_first: '— 大カテゴリを選択 —',
    sub_category_required: 'サブカテゴリを選択してください。',
    acquisition_date: '仕入日',
    source_platform: '仕入元',
    acquisition_type: '仕入種別',
    acquisition_cost: '仕入原価（円）',
    original_price: '想定価格（円）※傷補償用',
    condition: '状態',
    location_area: '保管場所',
    notes: '備考',
    save_acquisition: '仕入を保存',
    recently_acquired: '最近仕入れた商品（直近10件）',
    no_acquisitions: 'まだ仕入記録がありません。上記から追加してください。',
    filters: 'フィルター',
    status: '状態',
    location: '保管場所',
    search_title: 'タイトルで検索',
    all: 'すべて',
    apply: '反映',
    clear_filters: 'フィルターをクリア',
    all_items: '全商品',
    add_item: '商品を追加',
    no_items_match: '条件に一致する商品がありません。',
    edit: '編集',
    delete: '削除',
    loading: '読み込み中…',
    save: '保存',
    cancel: 'キャンセル',
    actions: '操作',
    id: 'ID',
    actions_label: '操作',
    new_good: '良い',
    new_fair: '普通',
    new_poor: '悪い',
    free: '無料',
    cheap: '安価',
    bought: '購入',
    output_title: '販売・レンタル',
    output_intro: '在庫・掲載中・予約中の商品から販売またはレンタルします。',
    tab_sell: '販売',
    tab_rent: 'レンタル',
    create_sale: '販売する',
    create_rental: 'レンタル開始',
    search_pick_item: '商品を検索して選択',
    customer: '顧客',
    sale_price: '販売価格（円）',
    sale_date: '販売日',
    platform_sold: '販売プラットフォーム',
    confirm_sell: '販売を確定',
    rent_monthly: '月額レンタル料（円）',
    deposit: '保証金（円）',
    start_date: '開始日',
    expected_end_date: '想定終了日',
    confirm_rent: 'レンタルを開始',
    end_rental: 'レンタル終了',
    active_rentals: 'レンタル中一覧',
    no_active_rentals: 'レンタル中の商品はありません。',
    end_rental_btn: 'レンタル終了',
    end_date: '終了日',
    item_status_after: '返却後の商品状態',
    damage_fee: '損傷料金（円）',
    end_rental_confirm: 'レンタルを終了',
    select_item: '商品を選択',
    select_customer: '既存を選択または下で新規追加',
    use_new_customer: '新規顧客（下記）を使う',
    quick_add_customer: '顧客を簡単追加',
    customers_title: '顧客',
    all_customers: '顧客一覧',
    add_customer: '顧客を追加',
    no_customers: 'まだ顧客がいません。追加してください。',
    rentals_title: 'レンタル',
    sales_title: '販売',
    new_sale: '新規販売',
    new_rental: '新規レンタル',
    item_acquired: '商品を在庫に追加しました。',
    sale_recorded: '販売を記録し、商品を売却済みにしました。',
    rental_started: 'レンタルを開始し、商品をレンタル中にしました。',
    rental_ended: 'レンタルを終了しました。',
    failed_load: '読み込みに失敗しました。',
    buy_intro_html: 'Rednote、Facebook、知人などで入手した商品を記録します。新規は「<strong>在庫</strong>」になります。',
    select_placeholder: '選択',
    cat_fridge: '冷蔵庫',
    cat_washing_machine: '洗濯機',
    cat_bed: 'ベッド',
    cat_desk: 'デスク',
    cat_sofa: 'ソファ',
    cat_table: 'テーブル',
    cat_chair: '椅子',
    cat_other: 'その他',
    cond_new: '新品',
    platform_rednote: 'Rednote',
    platform_facebook: 'Facebook',
    platform_friends: '知人',
    platform_mercari: 'メルカリ',
    platform_jimoty: 'ジモティー',
    platform_yahoo_auctions: 'ヤフオク',
    platform_other: 'その他',
    placeholder_title: '例：小型冷蔵庫',
    placeholder_optional: '任意',
    placeholder_location: '例：新宿、池袋',
    placeholder_exact_location: '例：住所や詳細な場所',
    placeholder_platform_other: 'プラットフォーム名を入力',
    add_exact_location: '+ 正確な場所を追加（任意）',
    hide_exact_location: '− 正確な場所を隠す',
    exact_location: '正確な場所',
    status_in_stock: '在庫',
    status_listed: '掲載中',
    status_rented: 'レンタル中',
    status_sold: '売却済',
    status_reserved: '予約中',
    status_disposed: '廃棄',
    edit_rent_sale_note: 'レンタル・販売を記録する（Rentals/Salesページに表示）には、表の「rented」「sold」ボタンを使うとOutputページで記録できます。',
    select_item_placeholder: '— 商品を選択 —',
    select_customer_placeholder: '— 既存を選択または下で新規追加 —',
    platform_dropdown: '— プラットフォーム —',
    name_required: '名前 *',
    app_id_placeholder: 'プラットフォーム上のID',
    platform_name_placeholder: 'プラットフォーム名…',
    add_exact_location_where: '+ 正確な場所（届け先）を追加（任意）',
    placeholder_delivery: '例：住所や届け先',
    confirm_sell_btn: '販売を確定',
    confirm_rent_btn: 'レンタルを開始',
    search_by_title: 'タイトルで検索…',
    customer_required: '顧客 *',
    sale_price_required: '販売価格（円） *',
    sale_date_required: '販売日 *',
    rent_monthly_required: '月額レンタル料（円） *',
    start_date_required: '開始日 *',
    end_date_required: '終了日 *',
    item_available_sell: '商品（販売可能） *',
    item_available_rent: '商品（利用可能） *',
    rent_price_monthly_label: '月額レンタル料（円） *',
    all_sales: '販売一覧',
    no_sales_yet: 'まだ販売記録がありません。',
    no_sales_hint: 'Output（販売・レンタル）→ 販売タブ、または上の「新規販売」で記録が表示されます。商品一覧でステータスを「売却済」にしても販売記録は作成されません。',
    no_rentals_match: 'レンタルがありません。',
    no_rentals_hint: 'Output（販売・レンタル）→ レンタルタブ、または上の「新規レンタル」で記録が表示されます。商品一覧でステータスを「レンタル中」にしてもレンタル記録は作成されません。',
    modal_add_customer: '顧客を追加',
    modal_new_sale: '新規販売',
    modal_new_rental: '新規レンタル',
    modal_edit_customer: '顧客を編集',
    modal_reserve_item: '商品を予約',
    name_label: '名前 *',
    phone_label: '電話',
    email_label: 'メール',
    preferred_language_label: '希望言語',
    customer_type_label: '顧客タイプ',
    lang_japanese: '日本語',
    lang_english: '英語',
    lang_chinese: '中国語',
    type_buyer: '購入者',
    type_renter: 'レンタル客',
    type_both: '両方',
    sale_created: '販売を記録し、商品を売却済みにしました。',
    rental_created: 'レンタルを開始し、商品をレンタル中にしました。',
    rental_ended_msg: 'レンタルを終了し、商品を在庫に戻しました。',
    damage_fee_set: '損傷料金を設定しました。',
    item_updated: '商品を更新しました。',
    item_added: '商品を追加しました。',
    item_deleted: '商品を削除（廃棄）しました。',
    status_updated: 'ステータスを更新しました：',
    please_select_customer: '顧客を選択してください。',
    item_reserved: '商品を予約しました。',
    failed_load_dashboard: 'ダッシュボードの読み込みに失敗：',
    failed_load_backend: '読み込みに失敗しました。バックエンドは起動していますか？',
    select_customer_short: '— 顧客を選択 —',
    when_ending_rental: 'レンタル終了時',
    all_rentals: 'レンタル一覧',
    status_active: 'レンタル中',
    status_ended: '終了',
    status_overdue: '延滞',
    mark_damaged: '損傷として記録',
    damage_fee_default_label: '損傷料金（円）— デフォルト：商品原価',
    set_damage_fee: '損傷料金を設定',
    customer_updated: '顧客を更新しました。',
    customer_added: '顧客を追加しました。',
    item: '商品',
    monthly: '月額（円）',
    start: '開始',
    end: '終了',
    add_item: '商品を追加',
    edit_item: '商品を編集',
    name: '名前',
    language: '言語',
    type: 'タイプ',
    error_prefix: 'エラー：',
    error_unexpected: 'エラー：予期しない応答です。',
    reserve_btn: '予約する',
    undecided_yet: '未定',
    stock_title: '在庫入出',
    section_input: '入力（仕入）',
    section_output: '出力（販売・レンタル）',
    card_buy: '仕入',
    card_rent_sell: '販売・レンタル',
  }
};

var ROOMI_LANG = localStorage.getItem('roomi_lang') || 'en';

function t(key) {
  var tr = ROOMI_I18N[ROOMI_LANG];
  if (!tr) tr = ROOMI_I18N.en;
  return tr[key] != null ? tr[key] : (ROOMI_I18N.en[key] || key);
}

function setRoomiLang(lang) {
  ROOMI_LANG = lang;
  localStorage.setItem('roomi_lang', lang);
  document.querySelectorAll('[data-i18n]').forEach(function (el) {
    var k = el.getAttribute('data-i18n');
    if (k) el.textContent = t(k);
  });
  document.querySelectorAll('[data-i18n-placeholder]').forEach(function (el) {
    var k = el.getAttribute('data-i18n-placeholder');
    if (k) el.placeholder = t(k);
  });
  var intro = document.getElementById('buy-intro');
  if (intro && ROOMI_I18N[ROOMI_LANG] && ROOMI_I18N[ROOMI_LANG].buy_intro_html) intro.innerHTML = ROOMI_I18N[ROOMI_LANG].buy_intro_html;
  var langLinks = document.querySelectorAll('.lang-switch');
  langLinks.forEach(function (a) {
    if (a.dataset.lang === lang) a.classList.add('active'); else a.classList.remove('active');
  });
}

function applyI18n() {
  setRoomiLang(ROOMI_LANG);
}
